#!/bin/sh
# Grid Engine options
#$ -N bcf_stats
#$ -cwd
#$ -l h_rt=10:00:00
#$ -l h_vmem=16G
#$ -pe sharedmem 12
#$ -o o_extr
#$ -e e_extr
#$ -t 1-29
#$ -P roslin_prendergast_cores

# Initialise the Modules environment
. /etc/profile.d/modules.sh

#load modules
module load roslin/bcftools/1.9

#specify dirs 
#TARGET_DIR=/path/to/input/files
#OUTPUT_DIR=/path/to/outpute/directory

#get a list of g.vcfs
sampleid=$(ls -1 ${TARGET_DIR}/*.vcf.gz)

# Get file to be processed by *this* task
# Extract the Nth file in the list of files, $sampleid, where N == $SGE_TASK_ID

this_file=$(echo "${sampleid}" | sed -n ${SGE_TASK_ID}p)
echo Processing file: ${this_file} on $HOSTNAME

base=$(echo "$this_file" | cut -f 15 -d '/' | cut -f 1 -d '-')

for i in 1 2 

do
  bcftools view -l 9 ${this_file} --regions ${i} -o ${base}_chr${i}.vcf.gz
  
done
